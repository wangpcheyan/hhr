function authran(){var e=Math.floor(8999*Math.random()+1e3);$(".auth").text(e)}function getInfo(e,a){var r=new Date;r.setFullYear(e,a-1,1);var t=r.getDay();0==t&&(t=7),r.setFullYear(e,a,0);var n=r.getDate();d1=1!=t?7-t+2:1,week_count=Math.ceil((n-d1+1)/7)}function GetQuery(e){for(var a=location.search.slice(1),r=a.split("&"),t=0;t<r.length;t++){var n=r[t].split("=");if(n[0]==e)return n[1]}}function changeLink(){var e=GetQuery("year"),a=GetQuery("month"),r=parseInt(a);if(r>0?$(".subnav li").eq(r).css("background","#E8E6E6"):$(".subnav li").eq(0).css("background","#E8E6E6"),e>0&&$(".select").val(e),getInfo(e,a),week_count){var t=["一","二","三","四","五"];$(".month-week span").remove("span");for(var n=0;week_count>n;n++)$(".month-week").append("<span><a href='#'>第"+t[n]+"周</a></span>")}$(".month-week h3 a").attr("href",pathname+"?year="+e+"&month="+a);for(var o=$(".month-week span a").length,n=0;o>n;n++)$(".month-week span a").eq(n).attr("href",pathname+"?year="+e+"&month="+a+"&week="+(n+1));if(!a>0){if(!GetQuery("quarter")>0)$(".year-quarter h3 a").css("color","#249BF5");else{var i=GetQuery("quarter")-1;$(".year-quarter span a").eq(i).css("color","#249BF5")}$(".month-week").hide()}else{if(!GetQuery("week")>0)$(".month-week h3 a").css("color","#249BF5");else{var l=GetQuery("week")-1;$(".month-week span a").eq(l).css("color","#249BF5")}$(".year-quarter").hide()}$(".year-quarter h3 a").attr("href",pathname+"?year="+e);for(var d=$(".year-quarter span a").length,n=0;d>n;n++)$(".year-quarter span a").eq(n).attr("href",pathname+"?year="+e+"&quarter="+(n+1))}function linkSet(){for(var e=$(".subnav li a").length,a=$(".select").val(),r=1;e>r;r++)$(".subnav li a").eq(r).attr("href",pathname+"?year="+a+"&month="+r);$(".month-week h3 a").attr("href",pathname+"?year="+a+"&month="+GetQuery("month"));for(var t=$(".month-week span a").length,n=0;t>n;n++)$(".month-week span a").eq(n).attr("href",pathname+"?year="+a+"&month="+GetQuery("month")+"&week="+(n+1));$(".subnav li a").eq(0).attr("href",pathname+"?year="+a),$(".year-quarter h3 a").attr("href",pathname+"?year="+a);for(var o=$(".year-quarter span a").length,n=0;o>n;n++)$(".year-quarter span a").eq(n).attr("href",pathname+"?year="+a+"&quarter="+(n+1))}function selectChange(){for(var e=new Date,a=e.getFullYear(),r=parseInt(a)-2015,t=0;r>=t;t++)$(".select").append("<option>"+(parseInt(a)-t)+"</option>")}function getMonthWeek(e,a,r){var t=new Date(e,parseInt(a)-1,r),n=t.getDay(),o=t.getDate();return Math.ceil((o+6-n)/7)}function initAddTime(){var e=GetQuery("year"),a=GetQuery("month"),r=GetQuery("quarter"),t=GetQuery("week");!e>0&&!a>0&&!r>0&&!t>0?$(".plan-year").val($(".select").val()):($(".plan-year").val(e),$(".plan-month").val(a),$(".plan-quarter").val(r),$(".plan-week").val(t))}function screen(){var e=GetQuery("year"),a=GetQuery("month"),r=GetQuery("quarter"),t=GetQuery("week");e!=$(".select").val()&&(e=$(".select").val()),parameter="?year=",e>0&&(parameter+=e),a>0&&(parameter=parameter+"&month="+a),r>0&&(parameter=parameter+"&quarter="+r),t>0&&(parameter=parameter+"&week="+t),!e>0&&(parameter="?year="+$(".select").val())}function peopleValue(){peopleArr=$(".peopleList li input:checkbox[name='people']:checked").map(function(e,a){return $(a).val()}).get().join(",")}function selectId(){idArr=$("input:checkbox[name='id']:checked").map(function(e,a){return $(a).val()}).get().join(",")}function selectItem(){itemArr=$("input:checkbox[name='item']:checked").map(function(e,a){return $(a).val()}).get().join(",")}function performanceinitAddTime(){var e=GetQuery("year"),a=GetQuery("month"),r=GetQuery("quarter"),t=GetQuery("week");!e>0&&!a>0&&!r>0&&!t>0?$(".performance-year").val($(".select").val()):($(".performance-year").val(e),$(".performance-month").val(a),$(".performance-quarter").val(r),$(".performance-week").val(t))}$(".qr-login").mouseenter(function(){$(".login .form").stop(!0,!1).fadeOut(500,function(){$(".qr-code").stop(!0,!1).fadeIn(500)})}).mouseleave(function(){$(".qr-code").stop(!0,!1).fadeOut(500,function(){$(".login .form").stop(!0,!1).fadeIn(500)})});var ran=Math.floor(3*Math.random());$(".login").css("background","url(img/common/"+ran+".jpg) no-repeat center center");var bgran=Math.floor(3*Math.random());$(".register").css("background","url(img/common/"+bgran+".jpg) no-repeat center center");var isselected=!1;$(".checkbox").click(function(){isselected?($(".reg-btn").attr("disabled","true"),isselected=!1):($(".reg-btn").removeAttr("disabled"),isselected=!0)}),$(".register").mousemove(function(){0==$("input[type='checkbox']").is(":checked")?$(".reg-btn").attr("disabled","true"):$(".reg-btn").removeAttr("disabled")}),authran(),$(".reset").click(function(){authran()}),$(".verification").bind("input propertychange",function(){$(".verification").val()==$(".auth").text()?($(".cross").show(),$(".uncross").hide()):($(".cross").hide(),$(".uncross").show())}),$(".add-btn").mouseenter(function(){$(".self .dropdown").stop(!0,!1).slideUp(),$(".add-new .dropdown").stop(!0,!1).slideDown()}),$(".add-new .dropdown").mouseleave(function(){$(".add-new .dropdown").stop(!0,!1).slideUp()}),$(".user").mouseenter(function(){$(".add-new .dropdown").stop(!0,!1).slideUp(),$(".self .dropdown").stop(!0,!1).slideDown()}),$(".self .dropdown").mouseleave(function(){$(".self .dropdown").stop(!0,!1).slideUp()}),$(".item-div").mousemove(function(){var e=$(".item-div").index(this);$(".item-div .childItem-box").hide(),$(".item-div:eq("+e+") .childItem-box").show(),$(".item-div").removeClass("current"),$(".item-div").eq(e).addClass("current")}),$(".childItem-box").mouseleave(function(){$(".item-div .childItem-box").hide(),$(".item-div").removeClass("current")}),$(".hasChild").mousemove(function(){var e=$(".hasChild").index(this);$(".hasChild .grandson-box").hide(),$(".hasChild .grandson-box:eq("+e+")").show()}).mouseleave(function(){var e=$(".hasChild").index(this);$(".hasChild .grandson-box:eq("+e+")").hide(),$(".hasChild .thirdMnue").css({background:"none"})}),$(".childItem-box").mouseleave(function(){$(".hasChild .grandson-box").hide()}),$("body").click(function(){$(".dropdown").stop(!0,!1).slideUp()});var week_count=0,pathname=window.location.pathname,parameter="";selectChange(),initAddTime(),changeLink(),linkSet(),$(".select").change(function(){linkSet()});var range=GetQuery("range"),rank=GetQuery("rank");range>0&&$(".range").val(range),rank>0&&$(".rank").val(rank),$(".range").change(function(){screen(),window.location.href=$(".range").val()>0?pathname+parameter+"&range="+$(".range").val():pathname+parameter+"&range="+$(".range").val()+"&rank="+$(".rank").val()});var peopleSelectFlag=1;$(".selectPeople").click(function(){peopleSelectFlag?($(".selectPeople i").removeClass("fa-caret-down").addClass("fa-caret-up"),peopleSelectFlag=0):($(".selectPeople i").removeClass("fa-caret-up").addClass("fa-caret-down"),peopleSelectFlag=1),$(".peopleList").stop(!0,!1).slideToggle()});var peopleArr="";$(".peopleAll input[type=checkbox]").click(function(){$(this).is(":checked")?$(".peopleList li input:checkbox[name='people']").prop("checked",!0):$(".peopleList li input:checkbox[name='people']").prop("checked",!1),peopleValue(),screen(),""!=peopleArr&&$(".rank").val()>0?$(".peopleButton").attr("href",pathname+parameter+"&rank="+$(".rank").val()+"&people="+peopleArr):""==peopleArr?$(".peopleButton").attr("href",pathname+parameter+"#"):$(".peopleButton").attr("href",pathname+parameter+"&people="+peopleArr)});var isChecked=0;$(".peopleList li input:checkbox[name='people']").click(function(){peopleValue();for(var e=$(".peopleList li input:checkbox[name='people']"),a=e.length,r=0;a>r;r++)e.eq(r).is(":checked")?isChecked++:isChecked=0;isChecked==a?$(".peopleAll input[type=checkbox]").prop("checked",!0):$(".peopleAll input[type=checkbox]").prop("checked",!1),screen(),""!=peopleArr&&$(".rank").val()>0?$(".peopleButton").attr("href",pathname+parameter+"&rank="+$(".rank").val()+"&people="+peopleArr):""==peopleArr?$(".peopleButton").attr("href",pathname+parameter+"#"):$(".peopleButton").attr("href",pathname+parameter+"&people="+peopleArr)}),$(".peopleButton").click(function(){""==peopleArr&&alert("请选择一个人员")}),$(".rank").change(function(){screen(),window.location.href=$(".rank").val()>0&&$(".range").val()>0?pathname+parameter+"&range="+$(".range").val()+"&rank="+$(".rank").val():void 0==GetQuery("people")?pathname+parameter+"&rank="+$(".rank").val():pathname+parameter+"&people="+GetQuery("people")+"&rank="+$(".rank").val()});var a,b,c,d;$(".principal").change(function(){""!=$(".principal").val()&&(a=!0),a&&b&&c&&d&&$(".add").removeAttr("disabled")}),$(".participant").change(function(){""!=$(".participant").val()&&(b=!0),a&&b&&c&&d&&$(".add").removeAttr("disabled")}),$(".auditor").change(function(){""!=$(".auditor").val()&&(c=!0),a&&b&&c&&d&&$(".add").removeAttr("disabled")}),$(".level").change(function(){""!=$(".level").val()&&(d=!0),a&&b&&c&&d&&$(".add").removeAttr("disabled")});var e,f,g,h;$("#updateprincipal").change(function(){""!=$("#updateprincipal").val()&&(e=!0),e&&f&&g&&h&&""!=$(".updateId").val()&&$(".update").removeAttr("disabled")}),$("#updateparticipant").change(function(){""!=$("#updateparticipant").val()&&(f=!0),e&&f&&g&&h&&""!=$(".updateId").val()&&$(".update").removeAttr("disabled")}),$("#updateauditor").change(function(){""!=$("#updateauditor").val()&&(g=!0),e&&f&&g&&h&&""!=$(".updateId").val()&&$(".update").removeAttr("disabled")}),$("#updatelevel").change(function(){""!=$("#updatelevel").val()&&(h=!0),e&&f&&g&&h&&""!=$(".updateId").val()&&$(".update").removeAttr("disabled")});var idArr="";$(".id").click(function(){if(selectId(),$("#selectAll").is(":checked")&&$("#selectAll").prop("checked",!1),""!=idArr){if(void 0!=GetQuery("delid")||void 0!=GetQuery("cid")){for(var e=window.location.search,a=e.split("&"),r=a.length,t="",n=0;r-1>n;n++)t=t+a[n]+"&";$(".del").attr("href",t+"delid="+idArr),$(".commit").attr("href",t+"cid="+idArr)}else if(GetQuery("year")>0){var e=window.location.search;$(".del").attr("href",e+"&delid="+idArr),$(".commit").attr("href",e+"&cid="+idArr)}$(".updateId").val(idArr)}else $(".del").attr("href",""),$(".commit").attr("href","")}),$(".aUpdate").click(function(){var e=idArr.split(","),a=e.length;a>1?alert("只能修改一个数据行！"):""==e&&alert("请勾选一个数据行！")}),$(".aDel").click(function(){if(selectId(),""==idArr&&alert("请勾选一个数据行！"),!GetQuery("year")>0){var e=window.location.search+"?year="+$(".select").val();$(".del").attr("href",e+"&delid="+idArr),$(".commit").attr("href",e+"&cid="+idArr)}}),$(".commitAll").click(function(){if(selectId(),""==idArr&&alert("请勾选一个数据行！"),!GetQuery("year")>0){var e=window.location.search+"?year="+$(".select").val();$(".del").attr("href",e+"&delid="+idArr),$(".commit").attr("href",e+"&cid="+idArr)}}),$(".aAudit").click(function(){selectId(),""==idArr?alert("请勾选一个数据行！"):idArr>0&&$(".audit").removeAttr("disabled"),idArr>0?$(".auditId").val(idArr):""!=idArr&&(alert("只能勾选一个数据行！"),$(".auditId").val(""))}),$(".aEvaluate").click(function(){selectId(),""==idArr?alert("请勾选一个数据行！"):idArr>0&&$(".evaluate").removeAttr("disabled"),idArr>0?$(".evaluateId").val(idArr):""!=idArr&&(alert("只能勾选一个数据行！"),$(".evaluateId").val(""))}),$(".aDataSubmission").click(function(){selectId(),""==idArr?alert("请勾选一个数据行！"):idArr>0&&$(".dataSubmission").removeAttr("disabled"),idArr>0?$(".dataSubmissionId").val(idArr):""!=idArr&&(alert("只能勾选一个数据行！"),$(".dataSubmissionId").val(""))}),$(".aApprove").click(function(){selectId(),""==idArr?alert("请勾选一个数据行！"):idArr>0&&$(".approve").removeAttr("disabled"),idArr>0?$(".approveId").val(idArr):""!=idArr&&(alert("只能勾选一个数据行！"),$(".approveId").val(""))}),$("#selectAll").click(function(){if($(this).is(":checked"))if($("input[name='id']").prop("checked",!0),selectId(),""!=idArr){if(void 0!=GetQuery("delid")||void 0!=GetQuery("cid")){for(var e=window.location.search,a=e.split("&"),r=a.length,t="",n=0;r-1>n;n++)t=t+a[n]+"&";$(".del").attr("href",t+"delid="+idArr),$(".commit").attr("href",t+"cid="+idArr)}else if(GetQuery("year")>0){var e=window.location.search;$(".del").attr("href",e+"&delid="+idArr),$(".commit").attr("href",e+"&cid="+idArr)}$(".updateId").val(idArr)}else $(".del").attr("href",""),$(".commit").attr("href","");else $("input[name='id']").prop("checked",!1)});var arrow=1;$(".data .more").click(function(){$(".selectShowItem").stop(!0,!1).slideToggle(),arrow?($(".data .more img").attr("src","img/common/arrow_up.png"),arrow=0):($(".data .more img").attr("src","img/common/arrow_down.png"),arrow=1),$(this).focus()}),$(".selectShowItem").mouseleave(function(){$(".selectShowItem").stop(!0,!1).slideToggle(),$(".data .more img").attr("src","img/common/arrow_down.png")});var itemArr="";$(".selectAllItem").click(function(){if($(this).is(":checked")){$("input[name='item']").prop("checked",!0);for(var e=$("tbody tr").length,a=0;e>a;a++)$("tbody tr:eq("+a+") .toggle").removeClass("hide");$("thead tr .toggle").removeClass("hide")}else{$("input[name='item']").prop("checked",!1);for(var r=$("tbody tr").length,a=0;r>a;a++)$("tbody tr:eq("+a+") .toggle").addClass("hide");$("thead tr .toggle").addClass("hide")}}),$(".item").click(function(){var e=$(".item").index(this);if($(".item").eq(e).prop("checked")){for(var a=$("tbody tr").length,r=0;a>r;r++)$("tbody tr:eq("+r+") .toggle").eq(e).removeClass("hide");$("thead tr .toggle").eq(e).removeClass("hide")}else{for(var t=$("tbody tr").length,r=0;t>r;r++)$("tbody tr:eq("+r+") .toggle").eq(e).addClass("hide");$("thead tr .toggle").eq(e).addClass("hide")}for(var n=!1,o=$(".item").length,r=0;o>r;r++)0==$(".item").eq(r).prop("checked")&&(n=!0);n?$(".selectAllItem").prop("checked",!1):$(".selectAllItem").prop("checked",!0)}),performanceinitAddTime(),$(".performanceModel input[type=text]").bind("input propertychange",function(){""!=$(".norm").val()&&""!=$(".weight").val()&&""!=$(".aim").val()&&""!=$(".grade").val()&&""!=$(".data-origin").val()?$(".performanceGo").attr("disabled",!1):$(".performanceGo").attr("disabled",!0)});